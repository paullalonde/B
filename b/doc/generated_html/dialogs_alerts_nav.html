<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>B: Dialogs, Alerts and Navigation Services</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">B
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Dialogs, Alerts and Navigation Services </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Table of Contents:</p><ul>
<li><a class="el" href="dialogs_alerts_nav.html#dialog_modality">Dialog Modality</a><ul>
<li><a class="el" href="dialogs_alerts_nav.html#dialog_modality_class">The DialogModality Class</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#generic_lifecycle">Dialog Lifecycle</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#generic_example">An Example</a></li>
</ul>
</li>
<li><a class="el" href="dialogs_alerts_nav.html#dialog_class">Class Dialog</a><ul>
<li><a class="el" href="dialogs_alerts_nav.html#dialog_window_mutation">Dialog Window Mutation</a></li>
</ul>
</li>
<li><a class="el" href="dialogs_alerts_nav.html#alert_class">Class Alert</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#nav_dialogs">Class NavDialog and its Derivatives</a><ul>
<li><a class="el" href="dialogs_alerts_nav.html#ask_save_changes_dialog_class">Class AskSaveChangesDialog</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#ask_discard_changes_dialog_class">Class AskDiscardChangesDialog</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#ask_review_documents_dialog_class">Class AskReviewDocumentsDialog</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#nav_reply_dialog_class">Class NavReplyDialog</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#get_file_dialog_class">Class GetFileDialog</a></li>
<li><a class="el" href="dialogs_alerts_nav.html#put_file_dialog_class">Class PutFileDialog</a></li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="using_windows.html">Windows</a></dd></dl>
<p>In the present document, dialogs (with a lowercase "d") are defined to be more-or-less short-lived windows, which exist to notify the user of some situation or to receive input from them. They are dismissed more-or-less automatically, typically by clicking an OK or Cancel button or by typing their keyboard equivalents. Examples of dialogs in <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a> are the classes <a class="el" href="classB_1_1Dialog.html" title="Modal Dialogs, Modeless Dialogs, and Sheets. ">Dialog</a>, <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a>, and <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a> and its derivatives.</p>
<hr/>
 <h1><a class="anchor" id="dialog_modality"></a>
Dialog Modality</h1>
<p>Dialogs have an interesting characteristic: modality. A dialog's modality determines if and how user input is restricted during the time the dialog is displayed. <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a> supports three kinds of modality:</p>
<ol type="1">
<li>None. This produces a modeless dialog. The user is not restricted in any way from interacting with the application's windows.</li>
<li>Application-modal. This produces what is commonly known as a modal dialog. The user is prevented from interacting with the application's other windows until the dialog is dismissed.</li>
<li>Window-modal. This produces a sheet. The user is prevented from interacting with the sheet's parent window until the dialog is dismissed.</li>
</ol>
<p>A design goal of the <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a> framework is to allow applications to interact with dialog objects regardless of their modality. That means for example that the way a developer sets up, displays, and retrieves a result from an ordinary alert is the same as for an alert sheet. This has important ramifications for the functionality exposed by dialog classes.</p>
<h2><a class="anchor" id="dialog_modality_class"></a>
The DialogModality Class</h2>
<p><a class="el" href="classB_1_1Dialog.html" title="Modal Dialogs, Modeless Dialogs, and Sheets. ">Dialog</a> modality is represented in <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a> by the <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> class. This is a tiny helper class that contains a <code>WindowModality</code> value and possibly a <code>WindowRef</code>. It is used by <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a>'s dialog classes to specify a dialog object's desired modality.</p>
<p>There are two ways of constructing a <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> object. The first is to explicitly request a given modality. For example:</p>
<div class="fragment"><div class="line">DialogModality  modality;</div><div class="line">WindowRef       parentWindow;</div><div class="line"></div><div class="line"><span class="comment">// Set up modality for modeless dialog.</span></div><div class="line">modality = <a class="code" href="classB_1_1DialogModality.html#a51675af9a38b83bc1c541b9beae765e8">DialogModality::Modeless</a>();</div><div class="line"><span class="comment">// Set up modality for modal dialog.</span></div><div class="line">modality = <a class="code" href="classB_1_1DialogModality.html#a5ad39c0aad1dbeb4cc8d48a72ac891ab">DialogModality::Modal</a>();</div><div class="line"><span class="comment">// Set up modality for sheet.</span></div><div class="line">modality = <a class="code" href="classB_1_1DialogModality.html#ac97a5e7c2fd06ca1bcd69566f2b237a7">DialogModality::Sheet</a>(parentWindow);</div></div><!-- fragment --><p>The second way is to call <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a>'s constructor directly, and is appropriate when the modality is determined elsewhere. For example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowDialog(WindowModality windowModality, WindowRef parentWindow)</div><div class="line">{</div><div class="line">    DialogModality modality(windowModality, parentWindow);</div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="generic_lifecycle"></a>
Dialog Lifecycle</h2>
<p>Typically, displaying a dialog involves the following steps:</p>
<ol type="1">
<li>Instantiating the dialog object.</li>
<li>Configuring it, including setting its modality.</li>
<li>Entering it, which means displaying it according to its modality</li>
<li>Receiving results once the dialog is dismissed.</li>
</ol>
<p>To illustrate this process, let's take <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> as an example. Here is a portion of its class declaration:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Alert</div><div class="line">{</div><div class="line">    <span class="comment">// Instantiates and returns an ALERT with the given arguments.</span></div><div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> ALERT&gt;</div><div class="line">    <span class="keyword">static</span> std::auto_ptr&lt;ALERT&gt;</div><div class="line">                <a class="code" href="classB_1_1Alert.html#a8988b39a7a68556b00da47fe0e367f77">Make</a>(</div><div class="line">                    <span class="keyword">const</span> String&amp;                                   inMessageText, </div><div class="line">                    <span class="keyword">const</span> String&amp;                                   inInformativeText,</div><div class="line">                    <span class="keyword">const</span> DialogModality&amp;                           inModality,</div><div class="line">                    boost::function2&lt;void, const ALERT&amp;, Button&gt;    inFunction());</div><div class="line">    </div><div class="line">    <span class="comment">// Displays the nav dialog according to its modality.</span></div><div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> ALERT&gt;</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classB_1_1Alert.html#a41c345f2fa49fe04ecf52d419de74ea1">Enter</a>(std::auto_ptr&lt;ALERT&gt; inAlertPtr);</div><div class="line">    </div><div class="line">    ...</div><div class="line">};</div></div><!-- fragment --><p>Here, steps 1 and 2 above are performed by the Make() function. <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a>'s version of Make() is typical of dialog classes. It has the following common characteristics:</p>
<ul>
<li>It instantiates an object whose class is given in a template parameter. This allows clients to instantiate custom classes, as long as they derive from the dialog base class (<a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> in this example).</li>
<li>It returns the object wrapped in an <code>std::auto_ptr</code>. This means the ownership of the dialog object is transferred to the caller. The object will be destroyed when the <code>auto_ptr</code> goes out of scope in the caller. This also makes the transfer of the pointer-to-dialog-object to the caller exception-safe.</li>
<li>It takes a <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> object as an argument. This argument, unsurprisingly, specifies the dialog's modality and determines what happens when the dialog is entered.</li>
<li>It takes a callback. This callback is invoked once the dialog is dismissed. In order to write code that's independent of a dialog's modality, it's necessary to retrieve results only through this callback.</li>
<li>It takes other dialog-specific configuration information, in this case the message and informative text.</li>
</ul>
<p>Step 3 above is performed by the Enter() function. Again, <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a>'s version of Enter() is typical of dialog classes. It has the following common characteristics:</p>
<ul>
<li>It takes an <code>std::auto_ptr</code>. This implies that ownership of the dialog object is handed over to the Enter() function. Although an implementation detail, typically this means that the dialog object will be destroyed when the dialog is dismissed.</li>
<li>The exact type of the <code>std::auto_ptr</code> is given in a template parameter. Similarly to Make(), this allows clients to use custom classes.</li>
<li>It displays the dialog object, according to its modality. Specifically, this means:<ul>
<li>For a modeless dialog, the dialog is displayed and the function returns immediately.</li>
<li>For a modal dialog, the dialog is displayed and then enters a modal event loop. The function returns only once the dialog has been dismissed.</li>
<li>For a sheet, the dialog is displayed and the function returns immediately.</li>
</ul>
</li>
</ul>
<p>Finally, step 4 occurs once the dialog is dismissed. This is done by having the dialog object invoke the callback it was given in step 2. Recall that for modal dialogs this will occur from within the Enter() function, whereas for modeless dialogs and sheets it will typically occur after Enter() has returned.</p>
<h2><a class="anchor" id="generic_example"></a>
An Example</h2>
<p>Here's a simple example of a class that displays an <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> in a modality-neutral way.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyClass</div><div class="line">{</div><div class="line">    <span class="comment">// Display a confirmation alert with the given modality.</span></div><div class="line">    <span class="keywordtype">void</span>    MyAskForUserConfirmationBeforeDoingStuff(</div><div class="line">                <span class="keyword">const</span> DialogModality&amp;   inModality);</div><div class="line">    <span class="comment">// Responds to the user&#39;s choice.</span></div><div class="line">    <span class="keywordtype">void</span>    MyAlertCallback(</div><div class="line">                <span class="keyword">const</span> Alert&amp;            alert, </div><div class="line">                <a class="code" href="classB_1_1Alert.html#a370832216899669c2052db86ca6dd682">Alert::Button</a>           button);</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyClass::MyAskForUserConfirmationBeforeDoingStuff(</div><div class="line">    <span class="keyword">const</span> DialogModality&amp; inModality)</div><div class="line">{</div><div class="line">    <span class="comment">// Make the alert, then enter it.  Note the way the callback is set up.  </span></div><div class="line">    <span class="comment">// The boost::bind library is very convenient for passing in member </span></div><div class="line">    <span class="comment">// functions as callbacks.</span></div><div class="line">    </div><div class="line">    <a class="code" href="classB_1_1Alert.html#a41c345f2fa49fe04ecf52d419de74ea1">Alert::Enter</a>(Alert::Make&lt;Alert&gt;(</div><div class="line">        String(<span class="stringliteral">&quot;A message text&quot;</span>),</div><div class="line">        String(<span class="stringliteral">&quot;An informative text&quot;</span>),</div><div class="line">        inModality, </div><div class="line">        boost::bind(&amp;MyClass::MyAlertCallback, <span class="keyword">this</span>, _1, _2)));</div><div class="line">    </div><div class="line">    <span class="comment">// We can&#39;t actually &quot;do&quot; the stuff we want to do here, because depending </span></div><div class="line">    <span class="comment">// on inModality, the alert might not have been dismissed yet.  The </span></div><div class="line">    <span class="comment">// logical flow of control continues in MyAlertCallback.</span></div><div class="line">    <span class="comment">// </span></div><div class="line">    <span class="comment">// Veterans of Classic Mac OS will recognise this as similar to asynchronous </span></div><div class="line">    <span class="comment">// programming with the old File and Device managers.</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyClass::MyAlertCallback(</div><div class="line">    <span class="keyword">const</span> Alert&amp;            alert, </div><div class="line">    <a class="code" href="classB_1_1Alert.html#a370832216899669c2052db86ca6dd682">Alert::Button</a>           button)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (button == <a class="code" href="classB_1_1Alert.html#a370832216899669c2052db86ca6dd682a19118b7545b345f1d68bb998c816d64e">Alert::kOK</a>)</div><div class="line">    {</div><div class="line">        <span class="comment">// do stuff</span></div><div class="line">        ...</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>All dialog classes take callbacks that are in fact template instantiations of <code>boost::function&lt;&gt;</code>. This makes it easy to pass in not only free functions, but also member functions of various signatures. Check out <a href="http://www.boost.org/doc/html/function.html">Boost.Function</a> and <a href="http://www.boost.org/libs/bind/bind.html">boost::bind</a> for more information.</p>
<hr/>
 <h1><a class="anchor" id="dialog_class"></a>
Class Dialog</h1>
<p>The <a class="el" href="classB_1_1Dialog.html" title="Modal Dialogs, Modeless Dialogs, and Sheets. ">Dialog</a> class derives from <a class="el" href="classB_1_1Window.html" title="A Window Manager window. ">Window</a> and adds the ability for it to respond to commands such as <code>kHICommandOK</code> and <code>kHICommandCancel</code>. Usually, you will want to set up your dialog's nib so that the OK and Cancel buttons send those commands.</p>
<p>If instantiated normally (ie with <a class="el" href="classB_1_1Dialog.html#a5d85e99d576c3e2baad772689c6e6406" title="Instantiates and returns a DIALOG with the given modality and callback. ">Dialog::Make()</a>), the dialog's window's class will match its modality. The manner in which this is done is explained below. Once the dialog is instantiated, it may be entered via a call to Enter(). If the dialog is very simple, both functions may be combined by calling Start(). For example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowDialog(<span class="keyword">const</span> <a class="code" href="classB_1_1Nib.html">B::Nib</a>&amp; nib, <a class="code" href="classB_1_1AEObject.html">B::AEObject</a>* container, <span class="keyword">const</span> DialogModality&amp; modality)</div><div class="line">{</div><div class="line">    <span class="comment">// Instantiates a B::Dialog from the given nib, ensures that the dialog&#39;s window </span></div><div class="line">    <span class="comment">// class matches the given modality, then enters the dialog.  The dialog&#39;s result </span></div><div class="line">    <span class="comment">// (i.e. the command that dismissed it) will be passed to MyCallback.</span></div><div class="line">    </div><div class="line">    B::Dialog::Start&lt;B::Dialog&gt;(nib, <span class="stringliteral">&quot;my_dialog_name&quot;</span>, container, modality, &amp;MyCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyCallback(<a class="code" href="classB_1_1Dialog.html">B::Dialog</a>&amp; dialog, UInt32 command)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (command == kHICommandOK)</div><div class="line">    {</div><div class="line">        <span class="comment">// do stuff...</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>For cases where you specifically require an application-modal dialog, you may use Run() instead. It forces the dialog to be application-modal, enters the dialog, and waits until it's dismissed. It returns the dismissing command as the function result. For example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyConciseShowDialog(<span class="keyword">const</span> <a class="code" href="classB_1_1Nib.html">B::Nib</a>&amp; nib, <a class="code" href="classB_1_1AEObject.html">B::AEObject</a>* container)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> (B::Dialog::Run&lt;B::Dialog&gt;(nib, <span class="stringliteral">&quot;my_dialog_name&quot;</span>, container) == kHICommandOK);</div><div class="line">}</div></div><!-- fragment --><p>Of course, if you want to create any kind of non-trivial dialog, you will want to derive a class from <a class="el" href="classB_1_1Dialog.html" title="Modal Dialogs, Modeless Dialogs, and Sheets. ">Dialog</a> in order to manipulate the dialog's contents. Here is an outline of a class that does just that:</p>
<div class="fragment"><div class="line"><span class="comment">// forward declaration</span></div><div class="line"><span class="keyword">struct </span>MyInfo;</div><div class="line"></div><div class="line"><span class="keyword">class </span>MyDialog : <span class="keyword">public</span> <a class="code" href="classB_1_1Dialog.html">B::Dialog</a></div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <span class="comment">// Constructor.  The &#39;info&#39; argument allows the caller to pass information to the </span></div><div class="line">    <span class="comment">// dialog object.</span></div><div class="line">    MyDialog(WindowRef window, <a class="code" href="classB_1_1AEObject.html">B::AEObject</a>* container, <span class="keyword">const</span> MyInfo&amp; info);</div><div class="line">    </div><div class="line">    <span class="comment">// Perform some more initialisation here.</span></div><div class="line">    <span class="keywordtype">void</span>    MyPostConstructorInitialisation();</div><div class="line">    </div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    </div><div class="line">    <span class="comment">// Overrides from Window</span></div><div class="line">    </div><div class="line">    <span class="comment">// This is called when the dialog is first instantiated.  This is a good place to </span></div><div class="line">    <span class="comment">// call Window::FindView to locate the dialog&#39;s controls.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> Awaken(<span class="keyword">const</span> <a class="code" href="classB_1_1Nib.html">B::Nib</a>* nib);</div><div class="line">    </div><div class="line">    <span class="comment">// The window is about to become visible.  You can inject values into your controls </span></div><div class="line">    <span class="comment">// here.  The difference between this function and Awaken() is that this one is </span></div><div class="line">    <span class="comment">// called every time the dialog is made visible (useful for recycling dialogs), </span></div><div class="line">    <span class="comment">// whereas Awaken is only called once.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> HandleShowing();</div><div class="line">    </div><div class="line">    <span class="comment">// The window has just become invisible.  You can extract your controls&#39; values </span></div><div class="line">    <span class="comment">// here.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> HandleHidden();</div><div class="line">    </div><div class="line">    <span class="comment">// Overrides from Dialog</span></div><div class="line">    </div><div class="line">    <span class="comment">// This function is called when the OK button is clicked.  This is the place to commit </span></div><div class="line">    <span class="comment">// changes made by the user.  Note that Validate() will already have been called.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> ConfirmDialog(UInt32 inCommand);</div><div class="line">    </div><div class="line">    <span class="comment">// This function is called when the Cancel button is clicked.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> CancelDialog(UInt32 inCommand);</div><div class="line">    </div><div class="line">    <span class="comment">// Override this function to perform input validation on the dialog&#39;s contents.  </span></div><div class="line">    <span class="comment">// The function should return true if validation succeeded.</span></div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Validate(UInt32 inCommand);</div><div class="line">    </div><div class="line">};</div></div><!-- fragment --><p>The code to display the dialog would look like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyShowDialogWithState()</div><div class="line">{</div><div class="line">    std::pair&lt;OSPtr&lt;WindowRef&gt;, MyDialog*&gt;  dlgPtr;</div><div class="line">    </div><div class="line">    MyInfo  initialisationInfo;</div><div class="line">    </div><div class="line">    <span class="comment">// set up initialisationInfo ...</span></div><div class="line">    </div><div class="line">    <span class="comment">// instantiate the dialog</span></div><div class="line">    dlgPtr = B::Dialog::MakeWithState&lt;MyDialog&gt;(MyGetNib(), <span class="stringliteral">&quot;my_dialog_name&quot;</span>, </div><div class="line">                                                MyGetContainer(), initialisationInfo, </div><div class="line">                                                MyGetModality(), &amp;MyCallback);</div><div class="line">    </div><div class="line">    <span class="comment">// more initialisation ...</span></div><div class="line">    dlgPtr.second-&gt;MyPostConstructorInitialisation();</div><div class="line">    </div><div class="line">    <span class="comment">// enter the dialog.</span></div><div class="line">    </div><div class="line">    <a class="code" href="classB_1_1Dialog.html#af1027b8887e8176a7e71ce680a7a9ee1">B::Dialog::Enter</a>(dlgPtr);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyCallback(MyDialog&amp; dialog, UInt32 command)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (command == kHICommandOK)</div><div class="line">    {</div><div class="line">        <span class="comment">// do stuff...</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="dialog_window_mutation"></a>
Dialog Window Mutation</h2>
<p>The preceding section mentionned that a dialog's window class is set up to match its modality. What exactly does that mean?</p>
<p>OS-level windows in Mac OS X (i.e. <code>WindowRefs</code>) have a window class, which determines both the appearance and the behaviour of the window. For example, the window class of application-modal dialogs will typically be <code>kMovableModalWindowClass</code>, whereas that of sheets will be <code>kSheetWindowClass</code>. The window class is fixed in the nib file, and can't be changed once the <code>WindowRef</code> is created. Furthermore, various HIToolbox functions will return an error if an attempt is made to display a dialog in a way that contradicts its window class. For example, calling <code>ShowSheetWindow()</code> on a <code>WindowRef</code> having class <code>kMovableModalWindowClass</code> will result in an error.</p>
<p>This is bad news if one needs to determine a dialog's modality at runtime. One solution would be to duplicate a dialog's definition (in the nib file) for every modality required by the dialog. Needless to say, this would be onerous for the application developer.</p>
<p>Instead, <a class="el" href="namespaceB.html" title="The B framework&#39;s namespace. ">B</a> opts for a more sophisticated solution. At dialog-instantiation time (i.e., within Make() and MakeWithState()), the function checks if the window's class is compatible with its modality. If so, all is well. If not, a new <code>WindowRef</code> is created with a default window class for the given modality. The contents of the original <code></code>  are copied into the new one, and the old one is released. The dialog object is then instantiated with the new <code>WindowRef</code>.</p>
<p>This approach generally works well and allows applications to determine at run-time whether a dialog should be modeless, modal, or a sheet. However it does have drawbacks:</p>
<ul>
<li>If some of the views in the window don't support being moved between windows, this approach will obviously cause problems. Almost all currently supported HIToolbox controls support being moved between windows.</li>
<li>Windows having a custom view ID (as set in Interface Builder) aren't supported.</li>
<li>Reasonable defaults are chosen for various window properties. For example, if the desired modality is application-modal, the new window's class will be <code>kMovableModalWindowClass</code> and its brush will be <code>kThemeBrushMovableModalBackground</code>. This may not be satisfactory in every situation.</li>
</ul>
<hr/>
 <h1><a class="anchor" id="alert_class"></a>
Class Alert</h1>
<p>The <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> class encapsulates functions and data structures in the HIToolbox that are used to display standard alert windows.</p>
<p><a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> follows the typical dialog lifecyle as explained in <a class="el" href="dialogs_alerts_nav.html#generic_lifecycle">Dialog Lifecycle</a> above. There are several overloads of the Make() function, which allow as little or as much customisation as a developer is likely to need. If that is not enough, all of the alert's parameters can be set via individual member functions prior to entering the alert.</p>
<p>The simplest overload of Make() is invoked like this:</p>
<div class="fragment"><div class="line">std::auto_ptr&lt;B::Alert&gt; alertPtr;</div><div class="line"></div><div class="line">alertPtr = B::Alert::Make&lt;B::Alert&gt;(</div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Error Message&quot;</span>), </div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Something Informative&quot;</span>), </div><div class="line">                MyGetModality(), &amp;MyCallback);</div><div class="line"></div><div class="line"><span class="comment">// additional customisation may be performed via individual setters.</span></div><div class="line">alertPtr-&gt;SetButtonText(<a class="code" href="classB_1_1Alert.html#a370832216899669c2052db86ca6dd682a19118b7545b345f1d68bb998c816d64e">B::Alert::kOK</a>, <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Do It&quot;</span>));</div></div><!-- fragment --><p>This will instantiate an <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> which will display a single OK button.</p>
<p>The next overload of Make() allows for simple two-button alerts:</p>
<div class="fragment"><div class="line">std::auto_ptr&lt;B::Alert&gt; alertPtr;</div><div class="line"></div><div class="line">alertPtr = B::Alert::Make&lt;B::Alert&gt;(</div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Error Message&quot;</span>), </div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Something Informative&quot;</span>), </div><div class="line">                MyGetModality(), &amp;MyCallback,</div><div class="line">                <span class="keyword">true</span>, <span class="keyword">true</span>);</div></div><!-- fragment --><p>This will instantiate an <a class="el" href="classB_1_1Alert.html" title="Alert dialogs and sheets. ">Alert</a> which will display both the OK and Cancel buttons, as well as the "caution" icon (i.e. the yellow triangle).</p>
<p>The third overload allows one to create three-button alerts, to change the default and cancel buttons, and to change the buttons' text.</p>
<p>Once an alert is instantiated, it may be entered by calling Enter():</p>
<div class="fragment"><div class="line">std::auto_ptr&lt;B::Alert&gt; alertPtr = ... ;    <span class="comment">// one of the Make() functions</span></div><div class="line"></div><div class="line"><a class="code" href="classB_1_1Alert.html#a41c345f2fa49fe04ecf52d419de74ea1">B::Alert::Enter</a>(alertPtr);</div></div><!-- fragment --><p>As a convenience, the Start() function is shorthand for a call to Make() followed by a call to Enter(). There are three overloads of Start(), with arguments corresponding to the three overloads of Make(). For example:</p>
<div class="fragment"><div class="line">B::Alert::Start&lt;B::Alert&gt;(</div><div class="line">        <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Error Message&quot;</span>), </div><div class="line">        <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Something Informative&quot;</span>), </div><div class="line">        MyGetModality(), &amp;MyCallback);</div></div><!-- fragment --><p>Finally, there are convenience routines called Run() which allow the developer to instantiate an alert, display it in an application-modal fashion, wait until the alert has been dismissed, and retrieve the dismissing button. For example:</p>
<div class="fragment"><div class="line"><a class="code" href="classB_1_1Alert.html#a370832216899669c2052db86ca6dd682">B::Alert::Button</a> button;</div><div class="line"></div><div class="line">button = B::Alert::Run&lt;B::Alert&gt;(</div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Error Message&quot;</span>), </div><div class="line">                <a class="code" href="classB_1_1String.html">B::String</a>(<span class="stringliteral">&quot;Something Informative&quot;</span>));</div></div><!-- fragment --><p>Note that because the alert's modality is predetermined, and that the function returns the dismissing button, there's no need to specify either the alert's modality or a callback. There are three overloads of Run(), with arguments corresponding to the three overloads of Make().</p>
<hr/>
 <h1><a class="anchor" id="nav_dialogs"></a>
Class NavDialog and its Derivatives</h1>
<p>The <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a> class and its derived classes encapsulate the use of Navigation Services dialogs.</p>
<p><a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a> itself is an abstract base class. It provides the common functionality required of all Navigation Services dialogs, but doesn't actually create Navigation Services dialog objects (i.e., <code>NavDialogRefs</code>); that is left to derived classes.</p>
<p>The lifecycle of all NavDialogs follows the explanation in <a class="el" href="dialogs_alerts_nav.html#generic_lifecycle">Dialog Lifecycle</a> above. Note that dialog configuration can be very simple or very complex, depending on the particular dialog. A lot of the configuration is done via setter functions in <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a> itself; however, not all configuration functions have an effect on all nav dialogs. Consult Apple's Navigation Services documentation for more information. Note that the alert-style dialogs (eg <a class="el" href="classB_1_1AskSaveChangesDialog.html" title="Implements the standard &quot;Save Changes&quot; alert as per the Aqua HIG. ">AskSaveChangesDialog</a>) take all of their pertinent configuration information as arguments to their Make/Start/Run functions, so it usually isn't necessary to further configure them.</p>
<h2><a class="anchor" id="ask_save_changes_dialog_class"></a>
Class AskSaveChangesDialog</h2>
<p><a class="el" href="classB_1_1AskSaveChangesDialog.html" title="Implements the standard &quot;Save Changes&quot; alert as per the Aqua HIG. ">AskSaveChangesDialog</a> is an alert-style dialog which displays a "Save Changes" alert as per the Aqua HIG. It's very useful for implementing the Close and Quit commands. It derives directly from <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a>.</p>
<p>Beyond the usual <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> and callback arguments, the Make/Start/Run functions also take as arguments:</p><ol type="1">
<li>The display name of the file that's about to be closed.</li>
<li>A value in the <a class="el" href="classB_1_1AskSaveChangesDialog.html#addb0dab67bf926711d7bba609e3e3453" title="Enumerates the possible reasons for invoking this dialog. ">AskSaveChangesDialog::Context</a> enumeration, which indicates why the file is being closed. The dialog's result is a value in the <a class="el" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3" title="Enumerates the possible results of this dialog. ">AskSaveChangesDialog::Action</a> enumeration. An enum is used here because this dialog has three buttons, not just the usual OK/Cancel button pair.</li>
</ol>
<p>Here's a simple example that works for any dialog modality:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAskSaveChangesDialog(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; name, <a class="code" href="classB_1_1AskSaveChangesDialog.html#addb0dab67bf926711d7bba609e3e3453">B::AskSaveChangesDialog::Context</a> context)</div><div class="line">{</div><div class="line">    B::AskSaveChangesDialog::Start&lt;B::AskSaveChangesDialog&gt;(</div><div class="line">        MyGetModality(), name, context, </div><div class="line">        &amp;MyAskSaveChangesDialogCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyAskSaveChangesDialogCallback(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html">B::AskSaveChangesDialog</a>&amp; dialog, <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3">B::AskSaveChangesDialog::Action</a> action)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (action)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3af3e366135fe22aacea33bf4638387ba0">B::AskSaveChangesDialog::kSave</a>:</div><div class="line">        <span class="comment">// save the file</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3afaad3423a5d743509c6b4d8f4b6b3f98">B::AskSaveChangesDialog::kDontSave</a>:</div><div class="line">        <span class="comment">// don&#39;t save the file</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3ad655af337ba6eb274aa21f65e5264a76">B::AskSaveChangesDialog::kCancel</a>:</div><div class="line">        <span class="comment">// cancel the close</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If you specifically require an application-modal alert, the code can be simpler:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAppModalAskSaveChangesDialog(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; name, <a class="code" href="classB_1_1AskSaveChangesDialog.html#addb0dab67bf926711d7bba609e3e3453">B::AskSaveChangesDialog::Context</a> context)</div><div class="line">{</div><div class="line">    <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3">B::AskSaveChangesDialog::Action</a> action;</div><div class="line">    </div><div class="line">    action = B::AskSaveChangesDialog::Run&lt;B::AskSaveChangesDialog&gt;(name, context);</div><div class="line">    </div><div class="line">    <span class="keywordflow">switch</span> (action)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3af3e366135fe22aacea33bf4638387ba0">B::AskSaveChangesDialog::kSave</a>:</div><div class="line">        <span class="comment">// save the file</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3afaad3423a5d743509c6b4d8f4b6b3f98">B::AskSaveChangesDialog::kDontSave</a>:</div><div class="line">        <span class="comment">// don&#39;t save the file</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskSaveChangesDialog.html#af9058a68293fe4f0cc97a2f78dfd79a3ad655af337ba6eb274aa21f65e5264a76">B::AskSaveChangesDialog::kCancel</a>:</div><div class="line">        <span class="comment">// cancel the close</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="ask_discard_changes_dialog_class"></a>
Class AskDiscardChangesDialog</h2>
<p><a class="el" href="classB_1_1AskDiscardChangesDialog.html" title="Implements the standard &quot;Discard Changes&quot; alert. ">AskDiscardChangesDialog</a> is an alert-style dialog which displays a "Discard Changes" dialog, and is therefore useful for implementing the Revert command. It derives directly from <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a>.</p>
<p>Beyond the usual <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> and callback arguments, the Make/Start/Run functions also take as an argument the display name of the file that's about to be closed. The dialog returns <code>true</code> if the user clicked the Discard button; else it returns <code>false</code>.</p>
<p>Here's a simple example that works for any dialog modality:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAskDiscardChangesDialog(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; name)</div><div class="line">{</div><div class="line">    B::AskDiscardChangesDialog::Start&lt;B::AskDiscardChangesDialog&gt;(</div><div class="line">        MyGetModality(), name, </div><div class="line">        &amp;MyAskDiscardChangesDialogCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyAskDiscardChangesDialogCallback(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1AskDiscardChangesDialog.html">B::AskDiscardChangesDialog</a>&amp; dialog, <span class="keywordtype">bool</span> discard)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (discard)</div><div class="line">    {</div><div class="line">        <span class="comment">// revert the file</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If you specifically require an application-modal alert, the code can be simpler:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAppModalAskDiscardChangesDialog(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; name)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (B::AskDiscardChangesDialog::Run&lt;B::AskDiscardChangesDialog&gt;(name))</div><div class="line">    {</div><div class="line">        <span class="comment">// revert the file</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="ask_review_documents_dialog_class"></a>
Class AskReviewDocumentsDialog</h2>
<p><a class="el" href="classB_1_1AskReviewDocumentsDialog.html" title="Implements the standard &quot;Review Changes&quot; alert as per the Aqua HIG. ">AskReviewDocumentsDialog</a> is an alert-style dialog which displays a "Review Changes" alert as per the Aqua HIG, which specify it as being part of an application's shutdown sequence. It derives directly from <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a>.</p>
<p>Beyond the usual <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> and callback arguments, the Make/Start/Run functions also take as an argument the number of documents containing unsaved changes (i.e., the number of "dirty" documents). The dialog's result is a value in the <a class="el" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5a" title="Enumerates the possible results of this dialog. ">AskReviewDocumentsDialog::Action</a> enumeration. An enum is used here because this dialog has three buttons, not just the usual OK/Cancel button pair.</p>
<p>Note that developers will rarely need to invoke this dialog, because <a class="el" href="classB_1_1MultipleDocumentPolicy.html" title="A document policy for applications supporting multiple open documents. ">MultipleDocumentPolicy</a> already does so automatically. Note also that the Aqua HIG specify that this alert should always be application-modal; support for sheets is included for completeness only.</p>
<p>Here's a simple example that works for any dialog modality:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAskReviewDocumentsDialog(UInt32 count)</div><div class="line">{</div><div class="line">    B::AskReviewDocumentsDialog::Start&lt;B::AskReviewDocumentsDialog&gt;(</div><div class="line">        MyGetModality(), inDocumentCount, </div><div class="line">        &amp;MyAskReviewDocumentsDialogCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyAskReviewDocumentsDialogCallback(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html">B::AskReviewDocumentsDialog</a>&amp; dialog, <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5a">B::AskReviewDocumentsDialog::Action</a> action)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (action)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aadb9ee32980c382dc0e8bacb9fe497ade">B::AskReviewDocumentsDialog::kReview</a>:</div><div class="line">        <span class="comment">// review the changed documents</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aa759816839213b1c7189525d30550ecc0">B::AskReviewDocumentsDialog::kDiscard</a>:</div><div class="line">        <span class="comment">// discard all changes</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aa51da1de16ced90ba4385f45e6a62b57e">B::AskReviewDocumentsDialog::kCancel</a>:</div><div class="line">        <span class="comment">// cancel the quit</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>Normally however, this dialog is displayed in an application-modal fashion, so the code is simpler:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowAppModalReviewDocumentsDialog(UInt32 count)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (B::AskReviewDocumentsDialog::Run&lt;B::AskReviewDocumentsDialog&gt;(count))</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aadb9ee32980c382dc0e8bacb9fe497ade">B::AskReviewDocumentsDialog::kReview</a>:</div><div class="line">        <span class="comment">// review the changed documents</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aa759816839213b1c7189525d30550ecc0">B::AskReviewDocumentsDialog::kDiscard</a>:</div><div class="line">        <span class="comment">// discard all changes</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        </div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="classB_1_1AskReviewDocumentsDialog.html#af758e96d958996c704336b216c5d9d5aa51da1de16ced90ba4385f45e6a62b57e">B::AskReviewDocumentsDialog::kCancel</a>:</div><div class="line">        <span class="comment">// cancel the quit</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="nav_reply_dialog_class"></a>
Class NavReplyDialog</h2>
<p><a class="el" href="classB_1_1NavReplyDialog.html" title="Abstract base class for complex Navigation Services dialogs. ">NavReplyDialog</a> derives from <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a> and is also an abstract base class. It provides numerous additional services for the more complex NavServices dialogs. Its public interface supports:</p>
<ul>
<li>Retrieving a <code>NavReplyRecord</code>. The returned structure is wrapped in an <a class="el" href="classB_1_1AutoNavReply.html" title="Helper class for managing NavReplyRecord structures. ">AutoNavReply</a> object, which will ensure its proper disposal.</li>
<li>Setting up the file type pop-up menu. This menu is used for two purposes. In <a class="el" href="classB_1_1PutFileDialog.html" title="Implements the standard &quot;Save&quot; dialog as per the Aqua HIG. ">PutFileDialog</a>, it allows the user to choose which file format to use when saving the file. In the other dialogs (eg <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a>) it allows the user to filter the displayed file system contents. In all cases, the menu is optional.</li>
<li>Setting up a custom view area from a <a class="el" href="classB_1_1Nib.html" title="Helper class for loading nib-based UI. ">Nib</a>. This allows clients to insert their own UI widgets into the dialog.</li>
</ul>
<p>Since <a class="el" href="classB_1_1NavReplyDialog.html" title="Abstract base class for complex Navigation Services dialogs. ">NavReplyDialog</a>'s main purpose is to be derived from, it supports a large protected interface, part of which serves as hooks for derived classes. That interface can be subdivided into the following categories:</p>
<ul>
<li>Action notification. There are numerous virtual functions that are called whenever interesting things happen in the dialog. For example, PopupMenuSelect() is called when the user chooses an item in the file type pop-up menu.</li>
<li>Filtering hooks. A group of virtual functions can be overridden to customize the filtering that occurs for a given filter type.</li>
<li>Dialog control. There is a large number of functions that allow the nav dialog to be controlled in various ways. These are almost all wrappers around the <code>NavCustomControl()</code> function.</li>
</ul>
<h2><a class="anchor" id="get_file_dialog_class"></a>
Class GetFileDialog</h2>
<p><a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a> displays an "Open" dialog as per the Aqua HIG. It derives from <a class="el" href="classB_1_1NavReplyDialog.html" title="Abstract base class for complex Navigation Services dialogs. ">NavReplyDialog</a>.</p>
<p>Unlike the simpler nav dialogs derived directly from <a class="el" href="classB_1_1NavDialog.html" title="Abstract base class for Navigation Services dialogs. ">NavDialog</a>, <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a> doesn't allow for passing arguments (beyond the <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> and callback) to the Make/Start/Run functions. That's because the configuration of this dialog can be quite complex; so the task has been left to clients. The dialog returns <code>true</code> if the user clicked the Open button; else it returns <code>false</code>.</p>
<p>Here's a simple example that works for any dialog modality:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowGetFileDialog()</div><div class="line">{</div><div class="line">    B::GetFileDialog::Start&lt;B::GetFileDialog&gt;(</div><div class="line">        MyGetModality(), </div><div class="line">        &amp;MyGetFileDialogCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyGetFileDialogCallback(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1GetFileDialog.html">B::GetFileDialog</a>&amp; dialog, <span class="keywordtype">bool</span> good, <span class="keyword">const</span> NavReplyRecord&amp; reply)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (good)</div><div class="line">    {</div><div class="line">        <span class="comment">// the user chose a file, open it.</span></div><div class="line">        MyOpenFile(reply);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If you specifically require an application-modal dialog, the code can be simpler:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyShowAppModalGetFileDialog(NavReplyRecord&amp; reply)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> (B::GetFileDialog::Run&lt;B::GetFileDialog&gt;(reply));</div><div class="line">}</div></div><!-- fragment --><p><a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a>'s configuration functions all have to do with the file type pop-up menu. A lot of work was put into this menu because Navigation Services' filtering API is inordinately hard to use. It's based on matching files with creators &amp; file types, and on Mac OS X that's not very useful.</p>
<p>A number of factors affect the file type pop-up menu:</p>
<ul>
<li>The <code>kNavNoTypePopup</code> flag. This flag controls the visibility of the pop-up menu and takes precedence over other options. If the flag is set, then each file is matched against all of the entries in the document types array. The flag can be changed with SetFlag()/ClearFlag().</li>
<li>The document types array. This array is set with SetDocumentTypes(). There are various scenarios, depending on the number of elements in the array:<ol type="1">
<li>If the array is empty, then all files will match successfully, regardless of extension or file type.</li>
<li>If the array contains only one element, then the pop-up menu is not displayed (unless other factors cause it to be displayed) and files are matched against the element.</li>
<li>If the array contains more than one element, then the pop-up menu is displayed and contains one item per element. When one of the items in the pop-up menu is selected, the files are matched against the corresponding document type entry. In addition, an item called "All Readable Documents" is prepended to the pop-up menu which causes the files to be matched against <em>all</em> of the document type entries.</li>
</ol>
</li>
</ul>
<p>Here's an example of setting up a <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a> to display all of the document types declared in an application's bundle:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowGetFileDialogForAllFileTypes(<span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; docType)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1Bundle.html">B::Bundle</a>&amp;                bundle  = <a class="code" href="classB_1_1Bundle.html#a89ef871e02ed3d7bf1f62c5be6bf9451">B::Bundle::Main</a>();</div><div class="line">    std::auto_ptr&lt;B::GetFileDialog&gt; dlgPtr;</div><div class="line">    </div><div class="line">    <span class="comment">// Instantiate the dialog.</span></div><div class="line">    dlgPtr = B::GetFileDialog::Make&lt;B::GetFileDialog&gt;(</div><div class="line">                    MyGetModality(), &amp;MyGetFileDialogCallback);</div><div class="line">    </div><div class="line">    <span class="comment">// Set the document types from the main bundle.  This will read each doc type&#39;s </span></div><div class="line">    <span class="comment">// localised name from the default table (ie &quot;InfoPlist.strings&quot;) in the bundle.</span></div><div class="line">    <span class="comment">// The dialog&#39;s filter will then be set up to match files that correspond to any </span></div><div class="line">    <span class="comment">// of our doc types.</span></div><div class="line">    dlgPtr-&gt;SetDocumentTypes(bundle);</div><div class="line">    </div><div class="line">    <span class="comment">// We initially allow opening only those files which match docType.  The user </span></div><div class="line">    <span class="comment">// will however be able to change the filtering to anything that&#39;s in the </span></div><div class="line">    <span class="comment">// pop-up menu.</span></div><div class="line">    dlgPtr-&gt;SelectDocumentType(docType);</div><div class="line">    </div><div class="line">    <span class="comment">// Finally, we are ready to enter the dialog.</span></div><div class="line">    <a class="code" href="classB_1_1NavDialog.html#ad53d915aa29bb5aa6143f4f9ab89548b">B::NavDialog::Enter</a>(dlgPtr);</div><div class="line">}</div></div><!-- fragment --><p>Here's a slightly more complex example. This one sets up a <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a> to display a single document type:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowGetFileDialogForOneFileType(<span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; docType)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1Bundle.html">B::Bundle</a>&amp;                bundle  = <a class="code" href="classB_1_1Bundle.html#a89ef871e02ed3d7bf1f62c5be6bf9451">B::Bundle::Main</a>();</div><div class="line">    std::auto_ptr&lt;B::GetFileDialog&gt; dlgPtr;</div><div class="line">    <a class="code" href="classB_1_1Bundle.html#aa879e228e116304fcfa1c05864d284b8">B::Bundle::Iterator</a>             it;</div><div class="line">    </div><div class="line">    <span class="comment">// Find the DocumentType struct with the given name.</span></div><div class="line">    it = bundle.<a class="code" href="classB_1_1Bundle.html#a0d5d2987b4eff4b2997cee9ac3975b9a">FindDocumentTypeForTypeName</a>(docType);</div><div class="line">    B_ASSERT(it != bundle.<a class="code" href="classB_1_1Bundle.html#a5e4fb2e77a209afcad7b165dcc4e81e4">end</a>());</div><div class="line">    </div><div class="line">    <span class="comment">// Instantiate the dialog.</span></div><div class="line">    dlgPtr = B::GetFileDialog::Make&lt;B::GetFileDialog&gt;(</div><div class="line">                    MyGetModality(), &amp;MyGetFileDialogCallback);</div><div class="line">    </div><div class="line">    <span class="comment">// Set the document types.  This will read the doc type&#39;s localised name from </span></div><div class="line">    <span class="comment">// the default table (ie &quot;InfoPlist.strings&quot;) in the main bundle.</span></div><div class="line">    dlgPtr-&gt;SetDocumentTypes(bundle, NULL, it, it+1);</div><div class="line">    </div><div class="line">    <span class="comment">// Finally, we are ready to enter the dialog.</span></div><div class="line">    <a class="code" href="classB_1_1NavDialog.html#ad53d915aa29bb5aa6143f4f9ab89548b">B::NavDialog::Enter</a>(dlgPtr);</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="put_file_dialog_class"></a>
Class PutFileDialog</h2>
<p><a class="el" href="classB_1_1PutFileDialog.html" title="Implements the standard &quot;Save&quot; dialog as per the Aqua HIG. ">PutFileDialog</a> displays a "Save" dialog as per the Aqua HIG. It derives from <a class="el" href="classB_1_1NavReplyDialog.html" title="Abstract base class for complex Navigation Services dialogs. ">NavReplyDialog</a>.</p>
<p>Beyond the usual <a class="el" href="classB_1_1DialogModality.html" title="Helper object representing a dialog&#39;s modality. ">DialogModality</a> and callback arguments, the Make/Start/Run functions also take as an argument the suggest name of the file that's about to be saved. Note that this must be the actual file name, not the file's display name as is the case for <a class="el" href="classB_1_1AskSaveChangesDialog.html" title="Implements the standard &quot;Save Changes&quot; alert as per the Aqua HIG. ">AskSaveChangesDialog</a> and <a class="el" href="classB_1_1AskDiscardChangesDialog.html" title="Implements the standard &quot;Discard Changes&quot; alert. ">AskDiscardChangesDialog</a>. The dialog returns <code>true</code> if the user clicked the Save button; else it returns <code>false</code>. Note that there are important configuration functions that aren't called when invoking Start() or Run(), so a bit more work is required on the part of clients wishing to use them.</p>
<p>Here's a simple example that works for any dialog modality:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowPutFileDialog(<span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; filename)</div><div class="line">{</div><div class="line">    <span class="comment">// &quot;name&quot; becomes the default file name displayed in the dialog.</span></div><div class="line">    B::PutFileDialog::Start&lt;B::PutFileDialog&gt;(</div><div class="line">        MyGetModality(), filename, </div><div class="line">        &amp;MyPutFileDialogCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyPutFileDialogCallback(</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1PutFileDialog.html">B::PutFileDialog</a>&amp; dialog, <span class="keywordtype">bool</span> good, NavReplyRecord&amp; reply, <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; docType)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (good)</div><div class="line">    {</div><div class="line">        <span class="comment">// the user confirmed the dialog, save the file.</span></div><div class="line">        MySaveFile(reply);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If you specifically require an application-modal dialog, the code can be simpler:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyShowAppModalPutFileDialog(<span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; name, NavReplyRecord&amp; reply)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> (B::PutFileDialog::Run&lt;B::PutFileDialog&gt;(name, reply));</div><div class="line">}</div></div><!-- fragment --><p><a class="el" href="classB_1_1PutFileDialog.html" title="Implements the standard &quot;Save&quot; dialog as per the Aqua HIG. ">PutFileDialog</a>'s configuration functions all have to do with the file type pop-up menu. They are very similar to the functions in <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a>:</p>
<ul>
<li>SetDocumentTypes() allows one to specify the document types displayed in the pop-up menu. Unlike the version in <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a> however, this one can optionally take an extra string argument containing the "default" document type. The default document type is placed at the top of the pop-up menu and a separator is inserted between it and the other menu items.</li>
<li>SelectDocumentType() allows one to specify the "current" document type.</li>
</ul>
<p>Note that unlike <a class="el" href="classB_1_1GetFileDialog.html" title="Implements the standard &quot;Open&quot; dialog as per the Aqua HIG. ">GetFileDialog</a>, changing the contents of the pop-up menu or the currently selected item doesn't affect the filtering of file system objects in the browser portion of the dialog.</p>
<p>Here's an example of setting up a <a class="el" href="classB_1_1PutFileDialog.html" title="Implements the standard &quot;Save&quot; dialog as per the Aqua HIG. ">PutFileDialog</a> that allows the user to save in any of of the document types (i.e., file formats) declared in the application's bundle:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyShowPutFileDialogForAllFileTypes(<span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; filename, <span class="keyword">const</span> <a class="code" href="classB_1_1String.html">B::String</a>&amp; docType)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <a class="code" href="classB_1_1Bundle.html">B::Bundle</a>&amp;                bundle  = <a class="code" href="classB_1_1Bundle.html#a89ef871e02ed3d7bf1f62c5be6bf9451">B::Bundle::Main</a>();</div><div class="line">    std::auto_ptr&lt;B::PutFileDialog&gt; dlgPtr;</div><div class="line">    </div><div class="line">    <span class="comment">// Instantiate the dialog.</span></div><div class="line">    dlgPtr = B::PutFileDialog::Make&lt;B::PutFileDialog&gt;(</div><div class="line">                    MyGetModality(), filename, &amp;MyGetFileDialogCallback);</div><div class="line">    </div><div class="line">    <span class="comment">// Set the document types from the main bundle.  This will read each doc type&#39;s </span></div><div class="line">    <span class="comment">// localised name from the default table (ie &quot;InfoPlist.strings&quot;) in the bundle.</span></div><div class="line">    dlgPtr-&gt;SetDocumentTypes(bundle);</div><div class="line">    </div><div class="line">    <span class="comment">// Initially select the pop-up menu item corresponding to the current doc type of </span></div><div class="line">    <span class="comment">// our document.</span></div><div class="line">    dlgPtr-&gt;SelectDocumentType(docType);</div><div class="line">    </div><div class="line">    <span class="comment">// Finally, we are ready to enter the dialog.</span></div><div class="line">    <a class="code" href="classB_1_1NavDialog.html#ad53d915aa29bb5aa6143f4f9ab89548b">B::NavDialog::Enter</a>(dlgPtr);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
